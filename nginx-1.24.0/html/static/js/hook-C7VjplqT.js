var b=(a,I,i)=>new Promise((v,r)=>{var d=s=>{try{p(i.next(s))}catch(f){r(f)}},o=s=>{try{p(i.throw(s))}catch(f){r(f)}},p=s=>s.done?v(s.value):Promise.resolve(s.value).then(d,o);p((i=i.apply(a,I)).next())});import{ay as g,K as y,r as n,V as X,a7 as G,o as Q,i as Z,b as w,aV as ee,dJ as te,A as u,ah as ae,bl as P,aa as ne,D as se,aX as ie}from"./index-Zjjfkekr.js";import{u as oe,_ as ce}from"./index.vue_vue_type_script_setup_true_lang-D56-mopa.js";import{z as le}from"./index.esm-BcMmGP1h.js";import"./index-BmD-sjfu.js";var ue={VITE_PORT:"8848",VITE_HIDE_HOME:"false",VITE_PUBLIC_PATH:"/",VITE_ROUTER_HISTORY:"hash",VITE_CDN:"false",VITE_COMPRESSION:"none",VITE_API_PATH:"localApi",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_PATH:h}=ue,re=a=>g.request("get",`${h}/api/notification/list`,{params:a}),de=a=>g.request("post",`${h}/api/notification/update`,{data:a}),pe=a=>g.request("post",`${h}/api/notification/updateStatus`,{data:a}),fe=a=>g.request("post",`${h}/api/notification/add`,{data:a}),me=a=>g.request("post",`${h}/api/notification/del`,{data:a});function _e(a,I){const i=y({name:"",status:""}),v=n();n();const r=n([]),d=n(!0);n();const o=n({}),{switchStyle:p}=oe();n();const s=n([]),f=n(!0),T=n(0),l=y({total:0,pageSize:10,currentPage:1,background:!0}),$=[{label:"公告名称",prop:"name",minWidth:130},{label:"公告内容",prop:"content",minWidth:130},{label:"状态",prop:"status",minWidth:90,cellRenderer:e=>{var t;return Z(w("el-switch"),{size:e.props.size==="small"?"small":"default",loading:(t=o.value[e.index])==null?void 0:t.loading,modelValue:e.row.status,"onUpdate:modelValue":S=>e.row.status=S,"active-value":"1","inactive-value":"0","active-text":"已启用","inactive-text":"已停用","inline-prompt":!0,style:p.value,onChange:()=>A(e)},null)}},{label:"备注",prop:"remark",minWidth:130},{label:"创建时间",minWidth:90,prop:"createTime",formatter:({createTime:e})=>ee(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:180,slot:"operation"}],x=X(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]),H=y({newPwd:""}),M=n();function A({row:e,index:t}){te.confirm(`确认要<strong>${e.status==="0"?"停用":"启用"}</strong><strong style='color:var(--el-color-primary)'>${e.name}</strong>公告吗?`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,draggable:!0}).then(()=>{o.value[t]=Object.assign({},o.value[t],{loading:!0}),pe({status:e.status,id:e.id}).then(()=>{o.value[t]=Object.assign({},o.value[t],{loading:!1}),u("已成功修改公告状态",{type:"success"})})}).catch(()=>{e.status===0?e.status=1:e.status=0})}function N(e){}function k(e){me({id:e.id}).then(()=>{u(`您删除了公告名称为${e.name}的这条数据`,{type:"success"}),c()})}function L(e){l.currentPage=1,l.pageSize=e,c()}function z(e){l.currentPage=e,c()}function F(e){T.value=e.length,a.value.setAdaptive()}function j(){T.value=0,a.value.getTableRef().clearSelection()}function U(){const e=a.value.getTableRef().getSelectionRows();u(`已删除公告编号为 ${ae(e,"id")} 的数据`,{type:"success"}),a.value.getTableRef().clearSelection()}function c(){return b(this,null,function*(){d.value=!0;const e=Object.assign(P(l),P(i)),{data:t}=yield re(e);r.value=t.data,l.total=t.total,setTimeout(()=>{d.value=!1},500)})}const q=e=>{e&&(e.resetFields(),c())};function B(e="新增",t){var S,D,R,E,C,V;ne({title:`${e}公告`,props:{formInline:{id:(S=t==null?void 0:t.id)!=null?S:"",name:(D=t==null?void 0:t.name)!=null?D:"",content:(R=t==null?void 0:t.content)!=null?R:"",institution:(E=t==null?void 0:t.institution)!=null?E:"",status:(C=t==null?void 0:t.status)!=null?C:"",remark:(V=t==null?void 0:t.remark)!=null?V:""}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>se(ce,{ref:v}),beforeSure:(W,{options:Y})=>{const J=v.value.getRef(),_=Y.props.formInline;function O(){u(`您${e}了公告名称为${_.name}的这条数据`,{type:"success"}),W(),c()}J.validate(K=>{K&&(e==="新增"?fe(_).then(m=>{m.errno===0?O():u(m.message,{type:"error"})}):de(_).then(m=>{m.errno===0?O():u(m.message,{type:"error"})}))})}})}return n(),G(H,({newPwd:e})=>M.value=ie(e)?-1:le(e).score),Q(()=>b(this,null,function*(){c()})),{form:i,loading:d,columns:$,dataList:r,treeData:s,treeLoading:f,selectedNum:T,pagination:l,buttonClass:x,onSearch:c,resetForm:q,onbatchDel:U,openDialog:B,handleUpdate:N,handleDelete:k,handleSizeChange:L,onSelectionCancel:j,handleCurrentChange:z,handleSelectionChange:F}}export{_e as useObj};
